<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Clock Gating | Home</title>
<meta name="keywords" content="rtl">
<meta name="description" content="Design &ndash; Testbench &ndash; RTL Design Directory
Clock Gating Clock gating is a widely used technique to reduce dynamic power consumption in digital circuits, particularly in complex systems like processors and FPGAs. Before diving into the benefits of clock gating, let’s take a look at the following SystemVerilog code snippet:
always_ff@(posedge clk) if(en) Dout &lt;= Din; The gate-level diagram of this code is illustrated in Figure 1. In this design, a multiplexer (MUX) controls the data flow, ensuring that when the &lsquo;En&rsquo; signal is high, &lsquo;Din&rsquo; is passed to &lsquo;Dout&rsquo; on the next clock edge.">
<meta name="author" content="Kiran">
<link rel="canonical" href="http://localhost:1313/rtl_directory/2024_09_13_12_36_11_clock_gating/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.19a7d7ba8a856bc3605fc7ca61a989cac3905b8b7707571254a3f97e6b40052a.css" integrity="sha256-GafXuoqFa8NgX8fKYamJysOQW4t3B1cSVKP5fmtABSo=" rel="preload stylesheet" as="style">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/assets/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/assets/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/assets/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/rtl_directory/2024_09_13_12_36_11_clock_gating/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript>

<link rel="stylesheet" href="../../zcustom.css">

<link rel="stylesheet" href="/css/syntax.css" !important>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    }

</script>


<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Home (Alt + H)">Home</a>
            
            
            <div class="vertical-line" style="height: 20px;"></div>
            
            
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/rtl_directory/2024_06_05_00_21_53_rtl_design_directory" title="rtl">
                    <span> 


                           
                        
                         
                        rtl</span>  
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/sv_directory/2024_06_27_16_53_00_sv_verification_directory" title="sv">
                    <span> 


                           
                        
                         
                        sv</span>  
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/uvm_directory/2024_08_28_12_39_50_uvm_framework_directory" title="uvm">
                    <span> 


                           
                        
                         
                        uvm</span>  
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="">
                    <span> 


                           
                        
                            
                    
                    
                    

                    
                    
                    

                    
                    
                    
                    


                    
                    
                    
                    

                    
                    
                    
                    
                    
                    
                    
                    
                
                         
                        
                        <div style="text-decoration: none">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 20"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round" style="text-decoration: none">
                            <path d="M21 18V6H8L2 12L8 18H21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 12C12 13.1046 11.1046 14 10 14C8.89543 14 8 13.1046 8 12C8 10.8954 8.89543 10 10 10C11.1046 10 12 10.8954 12 12Z" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                        <line x1="7" y1="7" x2="7" y2="7"></line>
                        </svg> 
                        </div>
                        </span>  
                </a>
            </li>
        </ul>
    </nav>
</header>

<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Clock Gating
    </h1>
    <div class="post-meta"><span title='2024-09-13 12:36:00 -0400 EDT'>September 13, 2024</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;788 words&nbsp;·&nbsp;Kiran

</div>
  </header> 
  <div class="post-content"><p><a href="https://github.com/24x7fpga/iVerilog/blob/master/design/clk_gating/clk_gating.sv">Design</a> &ndash; <a href="https://github.com/24x7fpga/iVerilog/blob/master/tb_design/tb_clk_gating/tb_clk_gating.sv">Testbench</a> &ndash; <a href="/rtl_directory/2024_06_05_00_21_53_rtl_design_directory/">RTL Design Directory</a></p>
<h2 id="clock-gating">Clock Gating<a hidden class="anchor" aria-hidden="true" href="#clock-gating">#</a></h2>
<p>Clock gating is a widely used technique to reduce dynamic power consumption in digital circuits, particularly in complex systems like processors and FPGAs. Before diving into the benefits of clock gating, let’s take a look at the following SystemVerilog code snippet:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-verilog" data-lang="verilog"><span style="display:flex;"><span><span style="color:#66d9ef">always_ff</span>@(<span style="color:#66d9ef">posedge</span> clk)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">if</span>(en)
</span></span><span style="display:flex;"><span>     Dout <span style="color:#f92672">&lt;=</span> Din;
</span></span></code></pre></div><p>The gate-level diagram of this code is illustrated in Figure 1. In this design, a multiplexer (MUX) controls the data flow, ensuring that when the &lsquo;En&rsquo; signal is high, &lsquo;Din&rsquo; is passed to &lsquo;Dout&rsquo; on the next clock edge. However, this MUX can be replaced with an AND gate to describe the conditional effect more efficiently.</p>
<figure class="center !important">
    <img loading="lazy" src="/ox-hugo/dyn_pwr.svg"
         alt="Figure 1: Dynamic Power Loss" width="500px"/> <figcaption>
            <p><!-- raw HTML omitted -->Figure 1: <!-- raw HTML omitted -->Dynamic Power Loss</p>
        </figcaption>
</figure>

<p>In the design above, the flip-flop always receives the clock signal, leading to unnecessary power consumption even when the output &lsquo;Dout&rsquo; is not changing (i.e., when &lsquo;En&rsquo; is low). This continuous clock supply results in dynamic power loss, which can be significant, especially in large-scale designs.</p>
<p>When &lsquo;En&rsquo; is high, the flip-flop captures the &lsquo;Din&rsquo; value and updates &lsquo;Dout&rsquo; accordingly. When &lsquo;En&rsquo; is low, &lsquo;Dout&rsquo; remains unchanged. However, the flip-flop still receives the clock signal, toggling its internal circuitry and consuming power. Ideally, when the output is not required, it’s more efficient to disable the flip-flop by stopping the clock, thus saving power.</p>
<p>Incorporating clock gating in designs can significantly reduce dynamic power consumption, making it an essential technique in power-efficient digital systems.</p>
<h3 id="and-based-clock-gating">And Based Clock Gating<a hidden class="anchor" aria-hidden="true" href="#and-based-clock-gating">#</a></h3>
<p>Clock gating tackles power consumption issue by adding logic to control the clock signal itself. When &lsquo;En&rsquo; is low, the clock to the flip-flop is gated (turned off), preventing unnecessary toggling and reducing power consumption. This gating mechanism can be implemented using an AND gate to control the clock signal based on the &lsquo;En&rsquo; condition.</p>
<figure class="center !important">
    <img loading="lazy" src="/ox-hugo/and_gate.svg"
         alt="Figure 2: And Based Clock Gating" width="500px"/> <figcaption>
            <p><!-- raw HTML omitted -->Figure 2: <!-- raw HTML omitted -->And Based Clock Gating</p>
        </figcaption>
</figure>

<p>At first glance, the design might seem straightforward, but it comes with its own set of challenges. One key issue is its susceptibility to glitches, as can be seen in the waveform.</p>
<figure class="center !important">
    <img loading="lazy" src="/ox-hugo/glitch.svg"
         alt="Figure 3: Glitches in Gated Clock" width="350px"/> <figcaption>
            <p><!-- raw HTML omitted -->Figure 3: <!-- raw HTML omitted -->Glitches in Gated Clock</p>
        </figcaption>
</figure>

<p>When examining the waveform, it can be noticed that an unexpected transitions, or &ldquo;glitches,&rdquo; can occur. These glitches are typically caused by slight delays in the signal propagation, which can result in incorrect values being latched by the flip-flops. Even a simple design can face issues like these, especially when dealing with high-speed or asynchronous signals.</p>
<p>Addressing these glitches requires careful consideration of the circuit’s timing and synchronization, making the design more complex than it initially appears.</p>
<h3 id="latch-based-clock-gating">Latch Based Clock Gating<a hidden class="anchor" aria-hidden="true" href="#latch-based-clock-gating">#</a></h3>
<p>While an AND gate can be used for simple clock gating, this approach is prone to glitches due to the direct application of the enable signal &lsquo;En&rsquo;. To address this, a latch-based clock gating design is often implemented.</p>
<p>In this improved design, the enable signal En is first passed through a latch before being applied to the AND gate for clock gating. The latch helps synchronize the En signal, ensuring it changes state only when the clock is stable. This effectively eliminates glitches that can occur in the basic AND-gate-based clock gating design. This is a prime example of when using a latch is beneficial.</p>
<figure class="center !important">
    <img loading="lazy" src="/ox-hugo/gated_clk.svg"
         alt="Figure 4: Latch Based Clock Gating" width="500px"/> <figcaption>
            <p><!-- raw HTML omitted -->Figure 4: <!-- raw HTML omitted -->Latch Based Clock Gating</p>
        </figcaption>
</figure>

<p>In the waveform shown below, it can be seen how the use of a latch helps manage glitches on the enable signal &lsquo;En&rsquo;. Even if a glitch occurs on &lsquo;En&rsquo;, the negative edge-sensitive latch effectively &ldquo;smoothens&rdquo; it, ensuring that only stable transitions are passed through.</p>
<p>The output of this latch is then combined with the clock signal using an AND gate to produce a glitch-free gated clock. By allowing only clean transitions from the enable signal, this approach ensures that the gated clock is stable and reliable, preventing unintended toggling in the flip-flops. This is a key benefit of using latch-based clock gating over simple AND-gate designs.</p>
<figure class="center !important">
    <img loading="lazy" src="/ox-hugo/glitch_free.svg"
         alt="Figure 5: Clock Gating" width="500px"/> <figcaption>
            <p><!-- raw HTML omitted -->Figure 5: <!-- raw HTML omitted -->Clock Gating</p>
        </figcaption>
</figure>

<p>The code snippet below demonstrates how to implement a glitch-free gated clock using a latch.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-verilog" data-lang="verilog"><span style="display:flex;"><span><span style="color:#66d9ef">always_comb</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span>(<span style="color:#f92672">!</span>CLK)
</span></span><span style="display:flex;"><span>    Latch_En <span style="color:#f92672">&lt;=</span> En;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assign</span> G_CLK <span style="color:#f92672">=</span> Latch_En <span style="color:#f92672">&amp;</span> CLK;
</span></span></code></pre></div><h3 id="effects-of-clock-gating">Effects of Clock Gating<a hidden class="anchor" aria-hidden="true" href="#effects-of-clock-gating">#</a></h3>
<h4 id="pros">Pros<a hidden class="anchor" aria-hidden="true" href="#pros">#</a></h4>
<ul>
<li>
<p>Reduced Dynamic Power Consumption: By disabling the clock for inactive modules, clock gating significantly reduces power usage, making the system more efficient.</p>
</li>
<li>
<p>Lower Heat Dissipation and Enhanced battery life: With less power consumed, there is a corresponding decrease in heat generation, and reducing power consumption directly extends battery life helping to maintain the device&rsquo;s thermal performance.</p>
</li>
</ul>
<h4 id="cons">Cons<a hidden class="anchor" aria-hidden="true" href="#cons">#</a></h4>
<ul>
<li>
<p>Timing Violations: When additional logic, such as AND gates or latches, is introduced into the clock path, it can delay the clock signal, leading to setup or hold time violations.</p>
</li>
<li>
<p>Clock Skew: When using clock gating, the distribution of the gated clock can introduce skew between different parts of the circuit, affecting clock synchronization.</p>
</li>
</ul>


  </div>



  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/rtl/">Rtl</a></li>
    </ul>



    <div class="bottom-line" ></div>
    
    
    
      <img src="/img/org_mode.png" class="center" alt="footer" style="max-width:50px" />
    

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/"></a></span>
        
        


</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><footer class="footer">

</footer>



<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
